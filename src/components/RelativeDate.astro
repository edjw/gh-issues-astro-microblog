---
type Props = {
	date: string,
};
const { date: dateString } = Astro.props;

function getRelativeDate(dateString: string) {
    const date = new Date(dateString);
    const now = new Date();
    const diff = now.getTime() - date.getTime();
    const diffInMinutes = diff / 1000 / 60;
    const diffInHours = diffInMinutes / 60;
    const diffInDays = diffInHours / 24;
    const diffInWeeks = diffInDays / 7;
    const diffInMonths = diffInDays / 30;
    const diffInYears = diffInDays / 365;

    if (diffInMinutes < 1) {
        return 'just now';
    } else if (diffInMinutes < 60) {
        return `${Math.round(diffInMinutes)} minutes ago`;
    } else if (diffInHours < 24) {
        return `${Math.round(diffInHours)} hours ago`;
    } else if (diffInDays < 7) {
        return `${Math.round(diffInDays)} days ago`;
    } else if (diffInWeeks < 4) {
        return `${Math.round(diffInWeeks)} weeks ago`;
    } else if (diffInMonths < 12) {
        return `${Math.round(diffInMonths)} months ago`;
    } else {
        return `${Math.round(diffInYears)} years ago`;
    }
}

const relativeDate = getRelativeDate(dateString);

---

<time datetime={relativeDate}>
	{relativeDate}
</time>