<script is:inline>
function handlePostExpansion() {
  const allPosts = Array.from(document.querySelectorAll("li.postWrapper"));

  allPosts.forEach((post) => {
    const contentWrapper = post.querySelector("div.contentWrapper");
    if (!contentWrapper) return;

    const postContent = post.querySelector("div.postContent");
    if (!postContent) return;

    const showMoreButtonWrapper = post.querySelector(
      "div.showMoreButtonWrapper"
    );
    if (!showMoreButtonWrapper) return;

    const showMoreButton = showMoreButtonWrapper.querySelector("button");
    if (!showMoreButton) return;

    const contentWrapperHeight = contentWrapper.offsetHeight;
    const postContentHeight = postContent.scrollHeight;

    if (postContentHeight <= contentWrapperHeight) return;

    showMoreButtonWrapper.classList.remove("hidden");

    showMoreButton.addEventListener("click", () => {
      contentWrapper.classList.toggle("max-h-[512px]");
      showMoreButtonWrapper.classList.toggle("hidden");
    });
  });
}

document.addEventListener("astro:page-load", () => {
  handlePostExpansion();
});
</script>
